<div class="container">
  <h1>Create a New Survey</h1>

  <p>{{ message }}</p>

  <form name="createSurveyForm" novalidate role="form">
    <!-- Section for generic survey and algorithm information -->
    <div class="card-panel grey lighten-4">
      <!-- Section to input survey title -->
      <div class="form-control">
        <span class="label label-danger" ng-show="submitted && createSurveyForm.surveyTitle.$error.required">Required!</span>
        <label for="surveyName">Survey Name<span class="required-asterisk" style="color: red"> *</span></label>
        <input type="text" name="surveyName" ng-model="surveyName" class="form-control" required />
      </div>

      <!-- Section to input how many students will be sorted into teams -->
      <div class="row">
        <span class="label label-danger" ng-show="submitted && createSurveyForm.studentCount.$error.requred">Required!</span>
        <label for="studentCount">How many students will need to be sorted into a team?<span class="required-asterisk" style="color: red"> *</span></label>
        <input type="number" ng-model="studentCount" class="form-control" required />
      </div>

      <!-- Section to input minimum, maximum, and optimum group sizes for the algorithm -->
      <p>You may select the minimum, maximum, and optimum group sizes the algorithm will create.</p>
      <div class="row">
        <div class="col s4">
          <label for="minGroupSize">Minimum Group Size</label>
          <input type="number" name="minGroupSize" ng-model="groupSizes['min']" />
        </div>
        <div class="col s4">
          <label for="maxGroupSize">Maximum Group Size</label>
          <input type="number" name="maxGroupSize" ng-model="groupSizes['max']" />
        </div>
        <div class="col s4">
          <label for="optGroupSize">Optimum Group Size</label>
          <input type="number" name="optGroupSize" ng-model="groupSizes['opt']" />
        </div>
      </div>

      <!-- Section to input how many projects there are for dynamic loading -->
      <div class="row">
        <label for="projectCount">How many projects will be considered?</label>
        <input type="number" name="projectCount" ng-model="projectCount" />
      </div>
    </div>

    <p>Select questions that you would like your students to be asked on the first page of the student survey, and customize them according to your needs.</p>

    <!-- Section to input information about the first page of the survey -->
    <div class="card-panel grey lighten-4">
      <!-- Section to input description of first page-->
      <div class="form-control">
        <label for="firstPage">What description/introduction would you like to display on the first page of the student survey?</label>
        <textarea class="materialize-textarea" name="firstPage" ng-model="surveyDescription['page_one']"></textarea>
      </div>

      <!-- Section to input first name information -->
      <div class="form-control">
        <div class="row">
          <div class="col s4">
            <input type="checkbox" name="firstName" id="firstName" ng-model="firstName['included']" />
            <label for="firstName">Student First Name</label>
          </div>
          <div class="switch col s4">
            <label for="firstNameRequired">
              Optional
              <input type="checkbox" name="firstNameRequired" id="firstNameRequired" ng-model="firstName['required']" />
              <span class="lever"></span>
              Required
            </label>
          </div>
          <div class="col s4">
            <label for="firstNameSubtext">Description of first name</label>
            <textarea class="materialize-textarea" name="firstNameSubtext" ng-model="firstName['subtext']"></textarea>
          </div>
        </div>
        <!-- Section to input last name information -->
        <div class="row">
          <div class="col s4">
            <input type="checkbox" name="lastName" id="lastName" ng-model="lastName['included']" />
            <label for="lastName">Student Last Name</label>
          </div>
          <div class="switch col s4">
            <label for="lastNameRequired">
              Optional
              <input type="checkbox" name="lastNameRequired" id="lastNameRequired" ng-model="lastName['required']" />
              <span class="lever"></span>
              Required
            </label>
          </div>
          <div class="col s4">
            <label for="lastNameSubtext">Description of last name</label>
            <textarea class="materialize-textarea" name="lastNameSubtext" ng-model="lastName['subtext']"></textarea>
          </div>
        </div>
        <!-- Section to input preferred name information -->
        <div class="row">
          <div class="col s4">
            <input type="checkbox" name="preferredName" id="preferredName" ng-model="preferredName['included']" />
            <label for="preferredName">Student Preferred Name</label>
          </div>
          <div class="switch col s4">
            <label for="preferredNameRequired">
              Optional
              <input type="checkbox" name="preferredNameRequired" id="preferredNameRequired" ng-model="preferredName['required']" />
              <span class="lever"></span>
              Required
            </label>
          </div>
          <div class="col s4">
            <label for="preferredNameSubtext">Description of preferred name</label>
            <textarea class="materialize-textarea" name="preferredNameSubtext" ng-model="preferredName['subtext']"></textarea>
          </div>
        </div>
        <!-- Section to input overall GPA information -->
        <div class="row">
          <div class="col s4">
            <input type="checkbox" name="gpa" id="gpa" ng-model="overallGPA['included']" />
            <label for="gpa">Overall GPA</label>
          </div>
          <div class="switch col s4">
            <label for="gpaRequired">
              Optional
              <input type="checkbox" name="gpaRequired" id="gpaRequired" ng-model="overallGPA['required']" />
              <span class="lever"></span>
              Required
            </label>
          </div>
          <div class="col s4">
            <label for="gpaSubtext">Description for Overall GPA</label>
            <textarea class="materialize-textarea" name="gpaSubtext" ng-model="overallGPA['subtext']"></textarea>
          </div>
        </div>
        <!-- Section to input CS GPA information -->
        <div class="row">
          <div class="col s4">
            <input type="checkbox" name="csgpa" id="csgpa" ng-model="csGPA['included']" />
            <label for="csgpa">Compter Science GPA</label>
          </div>
          <div class="switch col s4">
            <label for="csgpaRequired">
              Optional
              <input type="checkbox" name="csgpaRequired" id="csgpaRequired" ng-model="csGPA['required']" />
              <span class="lever"></span>
              Required
            </label>
          </div>
          <div class="col s4">
            <label for="csgpaSubtext">Description for CS GPA</label>
            <textarea class="materialize-textarea" name="csgpaSubtext" ng-model="csGPA['subtext']"></textarea>
          </div>
        </div>
      </div>
    </div>

    <p>The second page of the survey will be focused on students' skills and competencies. Select skills that your students will be asked to rank themselves in terms of competency.</p>
    <!-- Section to input information for the second page of the student survey -->
    <div class="card-panel grey lighten-4">
      <!-- Second page survey description-->
      <div class="form-control">
        <label for="secondPage">What description/introduction would you like to display on the second page of the student survey?</label>
        <textarea class="materialize-textarea" name="secondPage" ng-model="surveyDescription['page_two']"></textarea>
      </div>

      <div class="row">
        <p>Skills the students will be asked to rank themselves as: 'expert', 'good', 'basic', or 'none'.</p>
      </div>

      <!-- Loops through all skills students will be asked to rate themselves in, allows the instructor to set 
        them as required or included -->
      <div ng-repeat="skill in rankedCategories">
        <div class="row">
          <div class="col s6">
            <input type="checkbox" name="{{ skill.name }}" id="{{ skill.name }}" ng-model="rankedCategories[skill.name]['included']" />
            <label for="{{ skill.name }}">{{ skill.label }}</label>
          </div>
          <div class="switch col s6">
            <label for="{{ skill.name + 'Required' }}">
              Optional
              <input type="checkbox" name="{{ skill.name + 'Required' }}" id="{{ skill.name + 'Required' }}" ng-model="rankedCategories[skill.name]['required']" />
              <span class="lever"></span>
              Required
            </label>
          </div>
        </div>
      </div>

      <div>
        <!-- Restricts the number of skills a student can input for the algorithm -->
        <div class="row">
          <label for="maxSkills">Select the maximum number of skills students may profess a desire to learn.</label>
          <input type="number" name="maxSkills" ng-model="maxSkills" />
        </div>

        <!-- Section where instructor can add and remove skills the students might be interested in learning-->
        <p>Select and input skills students may profess a desire to learn.</p>
        <md-chips ng-model="desiredSkills"></md-chips>
      </div>
    </div>

    <!-- Section to input information about the last page of the survey-->
    <div class="card-panel grey lighten-4">
      <!-- Description of second page -->
      <div class="form-control">
        <label for="thirdPage">What description/introduction would you like to display on the third page of the student survey?</label>
        <textarea class="materialize-textarea" name="thirdPage" ng-model="surveyDescription['page_three']"></textarea>
      </div>

      <!-- Loops through all the questions students will be asked about their project preferences; allows
        the instructors to set questions as required or included -->
      <div ng-repeat="option in projectPreferences">
        <div class="row">
          <div class="col s4">
            <input type="checkbox" name="{{ option.name }}" id="{{ option.name }}" ng-model="projectPreferences[option.name]['included']" />
            <label for="{{ option.name }}">{{ option.label }}</label>
          </div>
          <div class="switch col s4">
            <label>
              Optional
              <input type="checkbox" name="{{ option.name + 'Required'}}" id="{{ option.name + 'Required' }}" ng-model="projectPreferences[option.name]['required']" />
              <span class="lever"></span>
              Required
              {{ projectPreferences[option]['required']}}
            </label>
          </div>
          <div class="col s4">
            <label for="{{ option.name + 'Subtext' }}">Description for {{ option.label }}</label>
            <textarea class="materialize-textarea" name="{{ option.name + 'Subtext' }}" ng-model="projectPreferences[option.name]['subtext']"></textarea>
          </div>
        </div>
      </div>

      <!-- Section where instructor inputs information about the IP preference response -->
      <div class="row">
        <div class="col s4">
          <input type="checkbox" name="ipPref" id="ipPref" ng-model="ipPreference['included']" />
          <label for="ipPref">IP Preference</label>
        </div>
        <div class="switch col s4">
          <label>
            Optional
            <input type="checkbox" name="ipPrefRequired" id="ipPrefRequired" ng-model="ipPreference['required']" />
            <span class="lever"></span>
            Required
          </label>
        </div>
        <div class="col s4">
          <label for="ipPrefSubtext">Description for IP Preference</label>
          <textarea class="materialize-textarea" name="ipPrefSubtext" ng-model="ipPreference['subtext']"></textarea>
        </div>
      </div>

      <!-- Section where instructor can update what options are presented for IP preferences -->
      <div class="card-panel grey lighten-4">
        IP Preference Options:
        <div class="row">
          <input type="checkbox" name="retain" id="retain" ng-model="ipOptions['retainIncluded']" />
          <label for="retain">{{ ipOptions['retain'] }}</label>
        </div>
        <div class="row">
          <input type="checkbox" name="depends" id="depends" ng-model="ipOptions['dependsIncluded']" />
          <label for="depends">{{ ipOptions['depends'] }}</label>
        </div>
        <div class="row">
          <input type="checkbox" name="noPref" id="noPref" ng-model="ipOptions['noPrefIncluded']" />
          <label for="noPref">{{ ipOptions['noPref'] }}</label>
        </div>
      </div>

      <!-- Section where instructor can select if leadership is a required or available category -->
      <div class="row">
        <div class="col s4">
          <input type="checkbox" name="lead" id="lead" ng-model="leadership['included']" />
          <label for="lead">Leadership Role</label>
        </div>
        <div class="switch col s4">
          <label>
            Optional
            <input type="checkbox" name="leadRequired" id="leadRequired" ng-model="leadership['required']" />
            <span class="lever"></span>
            Required
          </label>
        </div>
        <div class="col s4">
          <label for="leadSubtext">Description for leadership role</label>
          <textarea class="materialize-textarea" name="leadSubtext" ng-model="leadership['subtext']"></textarea>
        </div>
      </div>

      <!-- Section where an instructor can edit what leadership preference a student may select-->
      <div class="card-panel grey lighten-4">
        Leadership Role Options:
        <div class="row">
          <input type="checkbox" name="strongFollow" id="strongFollow" ng-model="leadershipOptions['strongFollowIncluded']" />
          <label for="strongFollow">{{ leadershipOptions['strongFollow'] }}</label>
        </div>
        <div class="row">
          <input type="checkbox" name="preferFollow" id="preferFollow" ng-model="leadershipOptions['preferFollowIncluded']" />
          <label for="preferFollow">{{ leadershipOptions['preferFollow'] }}</label>
        </div>
        <div class="row">
          <input type="checkbox" name="equalLead" id="equalLead" ng-model="leadershipOptions['equalLeadIncluded']" />
          <label for="equalLead">{{ leadershipOptions['equalLead'] }}</label>
        </div>
        <div class="row">
          <input type="checkbox" name="preferLead" id="preferLead" ng-model="leadershipOptions['preferLeadIncluded']" />
          <label for="preferLead">{{ leadershipOptions['preferLead'] }}</label>
        </div>
        <div class="row">
          <input type="checkbox" name="strongLead" id="strongLead" ng-model="leadershipOptions['strongLeadIncluded']" />
          <label for="strongLead">{{ leadershipOptions['strongLead'] }}</label>
        </div>
      </div>

      <!-- Section where an instructor can change students inputting who they want to work with -->
      <div class="row">
        <div class="col s4">
          <input type="checkbox" name="preferredPartners" id="preferredPartners" ng-model="preferredPartners['included']" />
          <label for="preferredPartners">Preferred Partners</label>
        </div>
        <div class="switch col s4">
          <label>
            Optional
            <input type="checkbox" name="preferredPartnersRequired" id="preferredPartnersRequired" ng-model="preferredPartners['required']" />
            <span class="lever"></span>
            Required
          </label>
        </div>
        <div class="col s4">
          <label for="preferredPartnersSubtext">Description for requested partners</label>
          <textarea class="materialize-textarea" name="preferredPartnersSubtext" ng-model="preferredPartners['subtext']"></textarea>
        </div>
      </div>

      <!-- Section where an instructor can change students inputting who they CAN'T work with -->
      <div class="row">
        <div class="col s4">
          <input type="checkbox" name="bannedPartners" id="bannedPartners" ng-model="bannedPartners['included']" />
          <label for="bannedPartners">Banned Partners</label>
        </div>
        <div class="switch col s4">
          <label>
            Optional
            <input type="checkbox" name="bannedPartnersRequired" id="bannedPartnersRequired" ng-model="bannedPartners['required']" />
            <span class="lever"></span>
            Required
          </label>
        </div>
        <div class="col s4">
          <label for="bannedPartnersSubtext">Description for students requested not to work with</label>
          <textarea class="materialize-textarea" name="bannedPartnersSubtext" ng-model="bannedPartners['subtext']"></textarea>
        </div>
      </div>

    </div>

    <!-- Final section requesting information to help personalize/optimize the algorithm -->
    <div class="card-panel grey lighten-4">
      <p>Our algorithm seeks to minimize the group ranking that each student ends in (to therefore ensure the most students are getting their top choices) while still ensuring that all projects that must get a group do in fact receive a group. We have a maximum preference value that all teams must have in order to be formed, paid or otherwise. In the case that a required project does not have a low enough overall preference score, we have an option to manually change the student rankings of that project to ensure it still passes our maximum score requirements and receives a group.</p>
      <!-- Section for the highest preference score allowed for any paid group -->
      <div class="row">
        <label for="maxScore">Maximum preference score allowed for any group</label>
        <input type="number" name="maxScore" ng-model="maxScore" />
      </div>

      <!-- Section where rankings are changed if a paid group can't get a high enough average -->
      <div class="row">
        <input type="checkbox" name="changeRatings" id="changeRatings" ng-model="changeRatings" />
        <label for="changeRatings">Change group rankings if preference requirements are not met</label>
      </div>

      <!-- Section where one can toggle switching students out of groups or not -->
      <div class="row">
        <input type="checkbox" name="attemptReplace" id="attemptReplace" ng-model="attemptReplace" />
        <label for="attemptReplace">Attempt to replace a student if a better match for that group can be found</label>
      </div>

      <p>Similarly, our algorithm operates by weighting certain criterion higher than others. If you wish to change the weighting of any criteria different from the default, please input those changes here</p>
      <!-- Section where instructors can input desired weights for various categories -->
      <div class="row">
        <label for="knownWeight">Weight of skills students already have</label>
        <input type="number" name="knownWeight" ng-model="weights['known']" />
      </div>
      <div class="row">
        <label for="learnWeight">Weight of the skills students would like to learn</label>
        <input type="number" name="learnWeight" ng-model="weights['learn']" />
      </div>
      <div class="row">
        <label for="groupWeight">Weight of the student's preference score for the groups</label>
        <input type="number" name="groupWeight" ng-model="weights['group']" />
      </div>
      <div class="row">
        <label for="ipWeight">Weight of a student's preference to retain IP rights</label>
        <input type="number" name="ipWeight" ng-model="weights['ip']" />
      </div>
      <div class="row">
        <label for="ecWeight">How much of a boost should students receive for doing the extra credit?</label>
        <input type="number" name="ecWeight" ng-model="weights['extraCredit']" />
      </div>
      <div class="row">
        <label for="enemyWeight">Weight of a student's desire to avoid certain individuals</label>
        <input type="number" name="enemyWeight" ng-model="weights['enemy']" />
      </div>
      <div class="row">
        <input type="checkbox" name="leadImportant" id="leadImportant" ng-model="leadership['important']" />
        <label for="leadImportant">Is it important that teams have one, and only one, leader?</label>
      </div>
    </div>

    <!-- Submit the first part of the survey, move on to project input -->
    <button type="submit" ng-click="createSurvey(createSurveyForm)" class="btn btn-default purple lighten-1">Input Projects</button>
  </form>

</div>

<!-- TODO
  - Disable fields if the box is not selected
  - Made the IP preference and leadership and all of those prompts editable
  - Partition the projects stuff out into multiple pages -->
